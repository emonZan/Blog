<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>JS debounce example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <input type="text" id="search-input" />
    <p>input event fired times:<span id="fired-times"></span></p>
    <p>
      debounce search founcion execute times:<span id="debounce-times"></span>
    </p>
  </body>
</html>
<script>
  var timerId;
  const handleUserInput = function () {
    var firedTimesDom = document.getElementById("fired-times");
    firedTimes = firedTimesDom.innerHTML || 0; // 获取初始fire times
    firedTimesDom.innerHTML = parseInt(firedTimes) + 1; // fire times + 1
    debounce(callSearchApi, 300);
  };

  var debounce = function (callback, delay) {
    if (timerId) {
      clearTimeout(timerId); // 如果一直在请求，则不会调用
    }
    timerId = setTimeout(callback, delay); // 等请求结束之后，delay一段时间再调用
  };

  const callSearchApi = function () {
    var debounceSearchTimesDom = document.getElementById("debounce-times");
    debounceSearchTimes = debounceSearchTimesDom.innerHTML || 0; // 获取初始debounce search times
    debounceSearchTimesDom.innerHTML = parseInt(debounceSearchTimes) + 1; // debounce search times + 1
  };
  const inputBox = document.getElementById("search-input");
  inputBox.addEventListener("input", handleUserInput); // input添加监听事件
</script>
